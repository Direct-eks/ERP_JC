<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jc.backend.dao.CompanyMapper">

    <resultMap id="CompanyCategoryResultMap" type="org.jc.backend.entity.CompanyCategoryO">
        <result property="areaID" column="partner_company_area_id"/>
        <result property="name" column="name"/>
        <result property="remark" column="remark"/>
        <result property="treeLevel" column="tree_level"/>
    </resultMap>

    <resultMap id="CompanyResultMap" type="org.jc.backend.entity.CompanyO">
        <result property="companyID" column="partner_company_id"/>
        <result property="sequenceNumber" column="sequence_number"/>
        <result property="brandCode" column="brand_code"/>
        <result property="abbreviatedName" column="abbreviated_name"/>
        <result property="areaID" column="area_id"/>
        <result property="phone" column="phone"/>
        <result property="address" column="address"/>
        <result property="fax" column="fax"/>
        <result property="classification" column="classification"/>
        <result property="fullName" column="full_name"/>
        <result property="contactPerson" column="contact_person"/>
        <result property="contactNumber" column="contact_number"/>
        <result property="remark" column="remark"/>
        <result property="isActive" column="is_active"/>
        <result property="zipcode" column="zipcode"/>
        <result property="email" column="email"/>
        <result property="website" column="website"/>
    </resultMap>


    <select id="queryCompanyByFuzzySearch" resultMap="CompanyResultMap">
        select partner_company_id, sequence_number, brand_code, abbreviated_name, area_id, phone, address, fax, classification, full_name, contact_person, contact_number, remark, is_active, zipcode, email, website
        from c_partner_company
        where
        <choose>
            <when test="phone != '' and name != ''">
                abbreviated_name like #{name} and phone like #{phone}
            </when>
            <when test="name != ''">
                abbreviated_name like #{name}
            </when>
            <when test="phone != ''">
                phone like #{phone}
            </when>
        </choose>
    </select>

    <select id="queryCompanyCategories" resultMap="CompanyCategoryResultMap">
        select partner_company_area_id, name, remark, tree_level
        from c_partner_company_area
    </select>

    <select id="queryCompaniesByCategory" resultMap="CompanyResultMap">
        select partner_company_id, sequence_number, brand_code, abbreviated_name, area_id, phone, address, fax, classification, full_name, contact_person, contact_number, remark, is_active, zipcode, email, website
        from c_partner_company
        where area_id = #{id}
    </select>
    
</mapper>